{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://raw.githubusercontent.com/jakesower/spectragraph/main/schemas/spectragraph-schema.1.0.schema.json",
	"title": "SpectraGraph Schema",
	"description": "A metaschema for SpectraGraph schemas.",
	"type": "object",
	"required": ["resources"],
	"properties": {
		"$id": { "type": "string" },
		"$comment": { "type": "string" },
		"$schema": { "type": "string" },
		"version": { "type": "string" },
		"resources": {
			"type": "object",
			"minProperties": 1,
			"patternProperties": {
				"[^.$]": { "$ref": "#/definitions/resource" }
			}
		}
	},
	"definitions": {
		"attribute": {
			"$ref": "http://json-schema.org/draft-07/schema#"
		},
		"relationship": {
			"type": "object",
			"required": ["type", "cardinality", "inverse"],
			"properties": {
				"type": { "type": "string" },
				"cardinality": { "type": "string", "enum": ["one", "many"] },
				"inverse": { "type": ["string", "null"] }
			}
		},
		"resource": {
			"type": "object",
			"required": ["attributes", "relationships"],
			"properties": {
				"title": { "type": "string" },
				"description": { "type": "string" },
				"$comment": { "type": "string" },
				"plural": { "type": "string" },
				"singular": { "type": "string" },
				"idAttribute": { "type": "string" },
				"schema": {
					"type": "object",
					"description": "JSON Schema object for cross-field validation. Must not contain 'properties' field - use 'attributes' instead.",
					"allOf": [
						{ "$ref": "http://json-schema.org/draft-07/schema#" },
						{
							"not": {
								"required": ["properties"]
							}
						}
					]
				},
				"attributes": {
					"type": "object",
					"patternProperties": {
						"[^.$]": {
							"$ref": "#/definitions/attribute"
						}
					}
				},
				"relationships": {
					"type": "object",
					"patternProperties": {
						"[^.$]": {
							"$ref": "#/definitions/relationship"
						}
					}
				}
			}
		}
	}
}
